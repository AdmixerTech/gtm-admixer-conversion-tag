___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Admixer Conversion Tag",
  "categories": ["ATTRIBUTION", "ADVERTISING"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "This is an unofficial Admixer conversions tag for the Google Tag Manager Community Template Gallery. Please raise an issue if you find any bugs or have a question!",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "amRid",
    "displayName": "Click ID",
    "simpleValueType": true,
    "help": "Macro for transferring Click ID. The macro is added to the Landing page URL by the Admixer system and needs to be gathered from the URL and transferred to Admixer",
    "alwaysInSummary": true
  },
  {
    "type": "SELECT",
    "name": "typeConv",
    "displayName": "Conversion Type",
    "selectItems": [
      {
        "value": 1,
        "displayValue": "Visit"
      },
      {
        "value": 2,
        "displayValue": "Reach Page"
      },
      {
        "value": 3,
        "displayValue": "Click Element"
      },
      {
        "value": 4,
        "displayValue": "Buy"
      }
    ],
    "simpleValueType": true,
    "help": "The event you want to measure with the tag",
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "adPageUrl",
    "displayName": "Page URL",
    "simpleValueType": true,
    "help": "URL of the page where a particular conversion occurred",
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "adTrigger",
    "displayName": "Admixer Ad Trigger",
    "simpleValueType": true,
    "help": "This is the GTM Conversion ID, which can be found in the Admixer Tag manager settings.",
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "price",
    "displayName": "Price",
    "simpleValueType": true,
    "defaultValue": 0,
    "help": "Conversion cost for every sent conversion. Conversion cost is used further in Admixer for performance reporting",
    "alwaysInSummary": true
  },
  {
    "type": "TEXT",
    "name": "dataInput",
    "displayName": "Data",
    "simpleValueType": true,
    "help": "Additional data"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

////endpoint
const endpoint = 'https://inv-nets-eu.admixer.net/postclick?';

// connect API
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');
const encodeUriComponent = require('encodeUriComponent');
const log = require('logToConsole');

//getting data from template to var
const amRid = data.amRid;
const typeConv = data.typeConv;
const pageUrl = data.adPageUrl;
const adTrigger = data.adTrigger;
const price = data.price;
const dataInput = data.dataInput;


//test
//log('data =', amRid, typeConv, pageUrl, adTrigger, price, dataInput);

let url = endpoint  + 
      'am-rid=' + encodeUriComponent(amRid) + 
      '&type=' + encodeUriComponent(typeConv) + 
      '&pageUrl=' + encodeUriComponent(pageUrl) + 
      '&trigger=' + encodeUriComponent(adTrigger) + 
      '&price=' + encodeUriComponent(price);


//combining data to URL params
if(dataInput != undefined) {
  url = url + '&data=' + encodeUriComponent(dataInput);
}


//test
//log(url);

//sending data to endpoint on success
const onSuccess = () => {
  //log('Script loaded successfully.');
  data.gtmOnSuccess();
};
//log failure
const onFailure = () => {
  //log('Script load failed.');
  data.gtmOnFailure();
};
//sending data
if (queryPermission('inject_script', url)) {
  injectScript(url, onSuccess, onFailure);
} else {
  //log('Script load failed due to permissions mismatch.');
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://inv-nets-eu.admixer.net/postclick*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 13/04/2023, 16:22:29


